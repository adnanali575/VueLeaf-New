import{bp as le,bq as Ae,br as Me,bs as Pe,bt as H,bu as he,bv as $e,bw as ae,bx as ne,by as ve,bz as X,bA as fe,bB as me,bC as Le,bD as ze,bE as pe,bF as ye,bG as be,bH as we,bI as De,bJ as Ne,bK as Ee,bL as Te,bM as Ve,bN as xe,bO as _e,bP as Be,bQ as Oe,bR as He,d as ce,a5 as We,a6 as Ge,bm as Ie,bS as qe,a8 as Re,a9 as Qe,bT as Fe,aa as Ke,k as R,J as ue,o as de,K as Je,g as k,c as E,q as Z,e as m,ac as je,b as c,a as W,w as K,f as J,p as ie,F as j,r as Y,bU as Se,x as ke,h as re,t as Q,V as Ze,W as Ue,al as Xe,P as Ce,b5 as Ye,bV as et,n as oe,aN as tt,aA as at,aV as nt,aG as rt,M as st,ap as it,ad as ot}from"./main-Dr4KW1PH.js";import{_ as lt,a as ct}from"./CardContent.vue_vue_type_script_setup_true_lang-DIvyJq6m.js";import{C as ut}from"./chevron-down-Ddu5A6Pz.js";var dt=function(){function g(){this.angle=0,this.width=10,this.r=10,this.x=0,this.y=0}return g}(),gt=function(g){le(o,g);function o(e){var l=g.call(this,e)||this;return l.type="pointer",l}return o.prototype.getDefaultShape=function(){return new dt},o.prototype.buildPath=function(e,l){var d=Math.cos,_=Math.sin,r=l.r,w=l.width,p=l.angle,B=l.x-d(p)*w*(w>=r/3?1:2),a=l.y-_(p)*w*(w>=r/3?1:2);p=l.angle-Math.PI/2,e.moveTo(B,a),e.lineTo(l.x+d(p)*w,l.y+_(p)*w),e.lineTo(l.x+d(l.angle)*r,l.y+_(l.angle)*r),e.lineTo(l.x-d(p)*w,l.y-_(p)*w),e.lineTo(B,a)},o}(Ae);function ht(g,o){var e=g.get("center"),l=o.getWidth(),d=o.getHeight(),_=Math.min(l,d),r=H(e[0],o.getWidth()),w=H(e[1],o.getHeight()),p=H(g.get("radius"),_/2);return{cx:r,cy:w,r:p}}function se(g,o){var e=g==null?"":g+"";return o&&(Te(o)?e=o.replace("{value}",e):Ve(o)&&(e=o(g))),e}var vt=function(g){le(o,g);function o(){var e=g!==null&&g.apply(this,arguments)||this;return e.type=o.type,e}return o.prototype.render=function(e,l,d){this.group.removeAll();var _=e.get(["axisLine","lineStyle","color"]),r=ht(e,d);this._renderMain(e,l,d,_,r),this._data=e.getData()},o.prototype.dispose=function(){},o.prototype._renderMain=function(e,l,d,_,r){var w=this.group,p=e.get("clockwise"),B=-e.get("startAngle")/180*Math.PI,a=-e.get("endAngle")/180*Math.PI,D=e.getModel("axisLine"),x=D.get("roundCap"),L=x?xe:_e,y=D.get("show"),V=D.getModel("lineStyle"),N=V.get("width"),v=[B,a];Me(v,!p),B=v[0],a=v[1];for(var i=a-B,n=B,t=[],C=0;y&&C<_.length;C++){var T=Math.min(Math.max(_[C][0],0),1);a=B+i*T;var M=new L({shape:{startAngle:n,endAngle:a,cx:r.cx,cy:r.cy,clockwise:p,r0:r.r-N,r:r.r},silent:!0});M.setStyle({fill:_[C][1]}),M.setStyle(V.getLineStyle(["color","width"])),t.push(M),n=a}t.reverse(),Pe(t,function(u){return w.add(u)});var b=function(u){if(u<=0)return _[0][1];var s;for(s=0;s<_.length;s++)if(_[s][0]>=u&&(s===0?0:_[s-1][0])<u)return _[s][1];return _[s-1][1]};this._renderTicks(e,l,d,b,r,B,a,p,N),this._renderTitleAndDetail(e,l,d,b,r),this._renderAnchor(e,r),this._renderPointer(e,l,d,b,r,B,a,p,N)},o.prototype._renderTicks=function(e,l,d,_,r,w,p,B,a){for(var D=this.group,x=r.cx,L=r.cy,y=r.r,V=+e.get("min"),N=+e.get("max"),v=e.getModel("splitLine"),i=e.getModel("axisTick"),n=e.getModel("axisLabel"),t=e.get("splitNumber"),C=i.get("splitNumber"),T=H(v.get("length"),y),M=H(i.get("length"),y),b=w,u=(p-w)/t,s=u/C,h=v.getModel("lineStyle").getLineStyle(),z=i.getModel("lineStyle").getLineStyle(),S=v.get("distance"),f,P,A=0;A<=t;A++){if(f=Math.cos(b),P=Math.sin(b),v.get("show")){var $=S?S+a:a,O=new he({shape:{x1:f*(y-$)+x,y1:P*(y-$)+L,x2:f*(y-T-$)+x,y2:P*(y-T-$)+L},style:h,silent:!0});h.stroke==="auto"&&O.setStyle({stroke:_(A/t)}),D.add(O)}if(n.get("show")){var $=n.get("distance")+S,G=se($e(A/t*(N-V)+V),n.get("formatter")),I=_(A/t),q=f*(y-T-$)+x,te=P*(y-T-$)+L,ee=n.get("rotate"),F=0;ee==="radial"?(F=-b+2*Math.PI,F>Math.PI/2&&(F+=Math.PI)):ee==="tangential"?F=-b-Math.PI/2:Be(ee)&&(F=ee*Math.PI/180),F===0?D.add(new ae({style:ne(n,{text:G,x:q,y:te,verticalAlign:P<-.8?"top":P>.8?"bottom":"middle",align:f<-.4?"left":f>.4?"right":"center"},{inheritColor:I}),silent:!0})):D.add(new ae({style:ne(n,{text:G,x:q,y:te,verticalAlign:"middle",align:"center"},{inheritColor:I}),silent:!0,originX:q,originY:te,rotation:F}))}if(i.get("show")&&A!==t){var $=i.get("distance");$=$?$+a:a;for(var U=0;U<=C;U++){f=Math.cos(b),P=Math.sin(b);var ge=new he({shape:{x1:f*(y-$)+x,y1:P*(y-$)+L,x2:f*(y-M-$)+x,y2:P*(y-M-$)+L},silent:!0,style:z});z.stroke==="auto"&&ge.setStyle({stroke:_((A+U/C)/t)}),D.add(ge),b+=s}b-=s}else b+=u}},o.prototype._renderPointer=function(e,l,d,_,r,w,p,B,a){var D=this.group,x=this._data,L=this._progressEls,y=[],V=e.get(["pointer","show"]),N=e.getModel("progress"),v=N.get("show"),i=e.getData(),n=i.mapDimension("value"),t=+e.get("min"),C=+e.get("max"),T=[t,C],M=[w,p];function b(s,h){var z=i.getItemModel(s),S=z.getModel("pointer"),f=H(S.get("width"),r.r),P=H(S.get("length"),r.r),A=e.get(["pointer","icon"]),$=S.get("offsetCenter"),O=H($[0],r.r),G=H($[1],r.r),I=S.get("keepAspect"),q;return A?q=be(A,O-f/2,G-P,f,P,null,I):q=new gt({shape:{angle:-Math.PI/2,width:f,r:P,x:O,y:G}}),q.rotation=-(h+Math.PI/2),q.x=r.cx,q.y=r.cy,q}function u(s,h){var z=N.get("roundCap"),S=z?xe:_e,f=N.get("overlap"),P=f?N.get("width"):a/i.count(),A=f?r.r-P:r.r-(s+1)*P,$=f?r.r:r.r-s*P,O=new S({shape:{startAngle:w,endAngle:h,cx:r.cx,cy:r.cy,clockwise:B,r0:A,r:$}});return f&&(O.z2=C-i.get(n,s)%C),O}(v||V)&&(i.diff(x).add(function(s){var h=i.get(n,s);if(V){var z=b(s,w);ve(z,{rotation:-((isNaN(+h)?M[0]:X(h,T,M,!0))+Math.PI/2)},e),D.add(z),i.setItemGraphicEl(s,z)}if(v){var S=u(s,w),f=N.get("clip");ve(S,{shape:{endAngle:X(h,T,M,f)}},e),D.add(S),fe(e.seriesIndex,i.dataType,s,S),y[s]=S}}).update(function(s,h){var z=i.get(n,s);if(V){var S=x.getItemGraphicEl(h),f=S?S.rotation:w,P=b(s,f);P.rotation=f,me(P,{rotation:-((isNaN(+z)?M[0]:X(z,T,M,!0))+Math.PI/2)},e),D.add(P),i.setItemGraphicEl(s,P)}if(v){var A=L[h],$=A?A.shape.endAngle:w,O=u(s,$),G=N.get("clip");me(O,{shape:{endAngle:X(z,T,M,G)}},e),D.add(O),fe(e.seriesIndex,i.dataType,s,O),y[s]=O}}).execute(),i.each(function(s){var h=i.getItemModel(s),z=h.getModel("emphasis"),S=z.get("focus"),f=z.get("blurScope"),P=z.get("disabled");if(V){var A=i.getItemGraphicEl(s),$=i.getItemVisual(s,"style"),O=$.fill;if(A instanceof Le){var G=A.style;A.useStyle(ze({image:G.image,x:G.x,y:G.y,width:G.width,height:G.height},$))}else A.useStyle($),A.type!=="pointer"&&A.setColor(O);A.setStyle(h.getModel(["pointer","itemStyle"]).getItemStyle()),A.style.fill==="auto"&&A.setStyle("fill",_(X(i.get(n,s),T,[0,1],!0))),A.z2EmphasisLift=0,pe(A,h),ye(A,S,f,P)}if(v){var I=y[s];I.useStyle(i.getItemVisual(s,"style")),I.setStyle(h.getModel(["progress","itemStyle"]).getItemStyle()),I.z2EmphasisLift=0,pe(I,h),ye(I,S,f,P)}}),this._progressEls=y)},o.prototype._renderAnchor=function(e,l){var d=e.getModel("anchor"),_=d.get("show");if(_){var r=d.get("size"),w=d.get("icon"),p=d.get("offsetCenter"),B=d.get("keepAspect"),a=be(w,l.cx-r/2+H(p[0],l.r),l.cy-r/2+H(p[1],l.r),r,r,null,B);a.z2=d.get("showAbove")?1:0,a.setStyle(d.getModel("itemStyle").getItemStyle()),this.group.add(a)}},o.prototype._renderTitleAndDetail=function(e,l,d,_,r){var w=this,p=e.getData(),B=p.mapDimension("value"),a=+e.get("min"),D=+e.get("max"),x=new we,L=[],y=[],V=e.isAnimationEnabled(),N=e.get(["pointer","showAbove"]);p.diff(this._data).add(function(v){L[v]=new ae({silent:!0}),y[v]=new ae({silent:!0})}).update(function(v,i){L[v]=w._titleEls[i],y[v]=w._detailEls[i]}).execute(),p.each(function(v){var i=p.getItemModel(v),n=p.get(B,v),t=new we,C=_(X(n,[a,D],[0,1],!0)),T=i.getModel("title");if(T.get("show")){var M=T.get("offsetCenter"),b=r.cx+H(M[0],r.r),u=r.cy+H(M[1],r.r),s=L[v];s.attr({z2:N?0:2,style:ne(T,{x:b,y:u,text:p.getName(v),align:"center",verticalAlign:"middle"},{inheritColor:C})}),t.add(s)}var h=i.getModel("detail");if(h.get("show")){var z=h.get("offsetCenter"),S=r.cx+H(z[0],r.r),f=r.cy+H(z[1],r.r),P=H(h.get("width"),r.r),A=H(h.get("height"),r.r),$=e.get(["progress","show"])?p.getItemVisual(v,"style").fill:C,s=y[v],O=h.get("formatter");s.attr({z2:N?0:2,style:ne(h,{x:S,y:f,text:se(n,O),width:isNaN(P)?null:P,height:isNaN(A)?null:A,align:"center",verticalAlign:"middle"},{inheritColor:$})}),De(s,{normal:h},n,function(I){return se(I,O)}),V&&Ne(s,v,p,e,{getFormattedLabel:function(I,q,te,ee,F,U){return se(U?U.interpolatedValue:n,O)}}),t.add(s)}x.add(t)}),this.group.add(x),this._titleEls=L,this._detailEls=y},o.type="gauge",o}(Ee),ft=function(g){le(o,g);function o(){var e=g!==null&&g.apply(this,arguments)||this;return e.type=o.type,e.visualStyleAccessPath="itemStyle",e}return o.prototype.getInitialData=function(e,l){return Oe(this,["value"])},o.type="series.gauge",o.defaultOption={z:2,colorBy:"data",center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,roundCap:!1,lineStyle:{color:[[1,"#E6EBF8"]],width:10}},progress:{show:!1,overlap:!0,width:10,roundCap:!1,clip:!0},splitLine:{show:!0,length:10,distance:10,lineStyle:{color:"#63677A",width:3,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:6,distance:10,lineStyle:{color:"#63677A",width:1,type:"solid"}},axisLabel:{show:!0,distance:15,color:"#464646",fontSize:12,rotate:0},pointer:{icon:null,offsetCenter:[0,0],show:!0,showAbove:!0,length:"60%",width:6,keepAspect:!1},anchor:{show:!1,showAbove:!1,size:6,icon:"circle",offsetCenter:[0,0],keepAspect:!1,itemStyle:{color:"#fff",borderWidth:0,borderColor:"#5470c6"}},title:{show:!0,offsetCenter:[0,"20%"],color:"#464646",fontSize:16,valueAnimation:!1},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"#464646",fontSize:30,fontWeight:"bold",lineHeight:30,valueAnimation:!1}},o}(He);function mt(g){g.registerChartView(vt),g.registerSeriesModel(ft)}const pt={class:"relative w-full h-full"},yt=ce({__name:"KeywordChart",props:{messageId:{},data:{},type:{},config:{}},emits:["loaded"],setup(g,{emit:o}){We([Ge,Ie,qe,mt,Re,Qe,Fe,Ke]);const e=g;console.log("KeywordChart received props:",{messageId:e.messageId,data:e.data,type:e.type,config:e.config});const l=o,d=R(null),p={bar_chart:()=>{var x,L,y,V,N,v,i,n,t,C,T,M;console.log("getBarChartOptions called with data:",e.data);const a=((L=(x=e.config)==null?void 0:x.title)==null?void 0:L.includes("Sentiment Distribution"))&&!((V=(y=e.config)==null?void 0:y.title)!=null&&V.includes("Negative Sentiment Distribution")),D=((v=(N=e.config)==null?void 0:N.title)==null?void 0:v.includes("mentions for my brand"))||((n=(i=e.config)==null?void 0:i.title)==null?void 0:n.includes("Negative Sentiment Distribution by Platform"));return console.log("Chart type flags:",{isSentimentComparison:a,isForumDistribution:D}),{grid:{left:"5%",right:"4%",bottom:"10%",top:"8%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:b=>{const u=b[0];if(D)return`${u.name}<br/>${u.value} mentions`;if(a){const s=e.data.find(h=>h.keyword===u.name);return`${u.name}<br/>Sentiment: ${u.value.toFixed(2)}<br/>Mentions: ${(s==null?void 0:s.mentions)||0}`}return`${u.name}: ${u.value} mentions`}},xAxis:{type:"category",data:e.data.map(b=>b.keyword),name:((t=e.config)==null?void 0:t.xAxis)||"",axisLabel:{interval:0,rotate:D?45:30,fontSize:11,margin:15,hideOverlap:!1,formatter:b=>b.replace(/\s+/g," ").trim()},axisTick:{alignWithLabel:!0,show:!0}},yAxis:{type:"value",name:((C=e.config)==null?void 0:C.yAxis)||"Number of Mentions",nameLocation:"middle",nameGap:40,min:0,splitLine:{lineStyle:{color:"#f3f4f6"}}},series:[{type:"bar",data:e.data.map(u=>a?u.sentiment||0:u.mentions),itemStyle:{color:b=>{var u,s;if(D)return"#3b82f6";if(a){const h=b.data;return h>=.7?"#34d399":h>=.5?"#86efac":h>=.3?"#fbbf24":"#f87171"}return(s=(u=e.config)==null?void 0:u.title)!=null&&s.includes("Negative Sentiment")?"#f87171":"#86efac"}},barWidth:D?"50%":"40%",label:{show:(M=(T=e.config)==null?void 0:T.title)==null?void 0:M.includes("mentions for my brand"),position:"top",formatter:"{c}",fontSize:12},emphasis:{itemStyle:{color:"#60a5fa"}}}]}},pie_chart:()=>({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{type:"pie",radius:"70%",data:e.data.map(a=>({name:a.keyword,value:a.mentions})),emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}),gauge_chart:()=>{var y,V,N,v;const a=e.data[0],D=a.value,x=a.max,L=D/x;return{series:[{type:"gauge",startAngle:180,endAngle:0,min:((y=e.config)==null?void 0:y.min)||0,max:((V=e.config)==null?void 0:V.max)||100,splitNumber:10,radius:"100%",axisLine:{roundCap:!0,lineStyle:{width:30,color:[[L,{type:"linear",x:0,y:0,x2:1,y2:0,colorStops:[{offset:0,color:"#f87171"},{offset:.3,color:"#fbbf24"},{offset:.7,color:"#86efac"},{offset:1,color:"#34d399"}]}],[1,"#e5e7eb"]]}},pointer:{show:!1},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!0,distance:15,color:"#6b7280",fontSize:16,formatter:function(i){return i===a.max?`${a.max}`:i===0?"0":""}},title:{show:!0,offsetCenter:[0,"30%"],fontSize:16,color:"#374151",formatter:((N=e.config)==null?void 0:N.title)||"Score"},detail:{show:!0,offsetCenter:[0,"0%"],fontSize:36,fontWeight:"bold",color:"#374151",formatter:function(i){return Math.round(i)}},data:[{value:a.value,name:((v=e.config)==null?void 0:v.title)||"Score"}]}]}}};ue(()=>[e.data,e.type,e.config],()=>{var a;(a=d.value)!=null&&a.chart&&(d.value.chart.clear(),d.value.chart.setOption(p[e.type]()))},{deep:!0}),de(()=>{l("loaded")}),Je(()=>{var a;(a=d.value)!=null&&a.chart&&(d.value.chart.dispose(),d.value=null)});const B=a=>{d.value=a};return(a,D)=>(k(),E("div",pt,[(k(),Z(m(je),{onInit:B,option:p[a.type](),key:`${a.messageId}-${a.type}-${JSON.stringify(a.data)}-${JSON.stringify(a.config)}`,autoresize:"",class:"h-full w-full"},null,8,["option"]))]))}}),bt={class:"w-4 h-4 inline-block"},wt={key:0,viewBox:"0 0 16 16",class:"w-full h-full"},xt={key:1,viewBox:"0 0 16 16",class:"w-full h-full"},_t={key:2,viewBox:"0 0 16 16",class:"w-full h-full"},St=ce({__name:"SentimentIndicator",props:{sentiment:{}},setup(g){const o=g;return de(()=>{console.log("SentimentIndicator mounted, sentiment:",o.sentiment)}),ue(()=>o.sentiment,e=>{console.log("SentimentIndicator sentiment changed:",e)}),(e,l)=>(k(),E("div",bt,[e.sentiment==="positive"?(k(),E("svg",wt,l[0]||(l[0]=[c("rect",{width:"16",height:"16",fill:"#4CAF50"},null,-1),c("path",{d:"M8 4L12 10H4L8 4Z",fill:"white"},null,-1)]))):e.sentiment==="negative"?(k(),E("svg",xt,l[1]||(l[1]=[c("rect",{width:"16",height:"16",fill:"#F44336"},null,-1),c("path",{d:"M8 12L12 6H4L8 12Z",fill:"white"},null,-1)]))):(k(),E("svg",_t,l[2]||(l[2]=[c("rect",{width:"16",height:"16",fill:"#FFC107"},null,-1),c("path",{d:"M12 8L6 4V12L12 8Z",fill:"white"},null,-1)])))]))}});function kt(){const g=R([]),o=R(""),e=R(null),l=R(!1),d=R(null),_=["Show me the trend of mentions for my brand over the last 30 days","What's the latest buzz around my brand?","What is the overall brand rating for our company?","Show me posts where my brand is mentioned alongside competitors"],r=[{category:"Brand Reputation",questions:["Show me the most recent positive posts about my brand","Show me the most recent negative posts about my brand","Which platforms have the most negative sentiment about my brand?","Show me the ratio of positive to negative sentiments over the past month"]},{category:"Sentiment Analysis",questions:["Show me posts with high sentiment confidence","Show me posts that need sentiment review"]},{category:"Source Analysis",questions:["What sources give us the most consistent sentiment scores?","Which sources have the most variable sentiment?"]},{category:"Forum Activity",questions:["Show me our top performing forums","Compare activity across different forum tiers"]},{category:"Brand Rating",questions:["Show me our rating component breakdown","What's our daily rating activity look like?"]}],w=x=>x.map(L=>({value:L.score??L.value??0,max:L.max??100})),p=x=>x.type==="gauge_chart"?{...x,data:w(x.data)}:x;return{messages:g,input:o,selectedCategory:e,mainQuestions:_,categorizedQuestions:r,isLoading:l,error:d,sendMessage:async x=>{var L,y,V,N,v,i;if(x.trim())try{l.value=!0,d.value=null;const n=Date.now();g.value.push({id:n,text:x,sender:"user"}),o.value="";const t=Date.now()+1;g.value.push({id:t,text:"🤖 Robot brain doing backflips...",sender:"ai"});const C=await fetch("https://vueleaf.com/api/chat/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify({query:x})});if(!C.ok){const b=await C.text();throw new Error(`API Error: ${C.status} - ${b}`)}const T=(L=C.body)==null?void 0:L.getReader();if(!T)throw new Error("No response body available");const M=g.value.findIndex(b=>b.id===t);if(M!==-1)for(;;){const{done:b,value:u}=await T.read();if(b)break;const h=new TextDecoder().decode(u).split(`
`).filter(z=>z.trim());for(const z of h){if(!z.startsWith("{")||!z.endsWith("}")){console.warn("Skipping invalid JSON line:",z);continue}try{let S;try{S=JSON.parse(z)}catch(f){console.error("Error parsing chunk:",f,"Line:",z);continue}if(!S)continue;if(S.status==="processing")g.value[M]={id:t,text:"Processing your request...",sender:"ai"};else if(S.status==="complete"){const f=S.data;let P;(y=f.insights)!=null&&y.visualization&&(console.log("Raw visualization data:",f.insights.visualization),P=p(f.insights.visualization),console.log("Transformed visualization data:",P));const A=f.sentiment||((V=f.insights)==null?void 0:V.sentiment),$={id:t,text:((N=f.insights)==null?void 0:N.summary)||"Here's what I found...",sender:"ai",visualization:P,sentiment:A,insights:f.insights};g.value.length>10&&(g.value=g.value.slice(-10)),g.value[M]=$}else S.status==="error"&&(g.value[M]={id:t,text:S.message,sender:"ai"},d.value=S.message)}catch(S){console.error("Error parsing chunk:",S)}}}}catch(n){console.error("Chat error:",n);const t=((i=(v=n==null?void 0:n.response)==null?void 0:v.data)==null?void 0:i.error)||(n==null?void 0:n.message)||"An error occurred while processing your request";d.value=t,g.value.push({id:Date.now(),text:t,sender:"ai"})}finally{l.value=!1}},handleCategoryClick:x=>{e.value=x},handleQuestionClick:x=>{o.value=x,e.value=null}}}const Ct="/assets/teamwork-CNgbyZ1v.png",At={class:"flex-1 p-6"},Mt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Pt={class:"flex flex-col md:flex-row items-center gap-6 p-6"},$t={class:"w-48 h-48 flex-shrink-0 relative"},Lt=["src"],zt={key:0,class:"flex flex-col items-center justify-center h-[720px] bg-white p-6 text-center"},Dt={class:"w-16 h-16 bg-green-50 rounded-full flex items-center justify-center mb-6"},Nt={key:1,class:"space-y-4"},Et=["onMounted"],Tt={key:0},Vt={class:"flex items-center gap-2 mb-1"},Bt={class:"ml-4 text-gray-600 mb-3"},Ot={key:1},Ht={key:1},Wt={class:"flex items-center gap-2"},Gt=["innerHTML"],It={key:0,class:"mt-6 space-y-3"},qt={class:"list-disc list-inside space-y-3 text-gray-700 text-[16px]"},Rt={class:"p-4 bg-gray-50 border-t border-gray-200 rounded-b-lg"},Qt={class:"flex space-x-2"},Ft={class:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-white shadow-sm"},Kt={class:"p-6 space-y-6 pb-32"},Jt={class:"space-y-3 bg-white p-4 rounded-xl shadow-sm border border-gray-100"},jt={class:"flex items-center gap-2 text-gray-700 bg-gray-50 p-2 rounded-lg"},Zt={class:"space-y-2"},Ut={class:"flex items-center gap-2 text-gray-700 bg-gray-50 p-2 rounded-lg"},Xt={class:"font-medium"},Yt={class:"space-y-2"},ea={key:0,class:"fixed bottom-0 right-0 w-96 flex justify-center pointer-events-none z-[60]"},ta={class:"bg-green-200 text-green-900 rounded-full p-2 mb-6 relative shadow-sm"},aa=ce({__name:"ChatPage",setup(g){const o=R(!1),e=R(null),l=R(null),d=R(!0),_=()=>{if(l.value){const{scrollTop:i,scrollHeight:n,clientHeight:t}=l.value,C=n-i-t<50;d.value=!C}};ue(o,i=>{i&&Se(()=>{_()})});const{messages:r,input:w,mainQuestions:p,categorizedQuestions:B,isLoading:a,error:D,sendMessage:x,handleQuestionClick:L}=kt(),y=async()=>{await Se(),setTimeout(()=>{if(e.value){const i=e.value.scrollHeight;e.value.scrollTo({top:i,behavior:"smooth"})}},100)},V=x,N=async i=>{await V(i),await y()};de(()=>{y()});const v=i=>{i.key==="Enter"&&!i.shiftKey&&!a.value&&(i.preventDefault(),N(w.value))};return(i,n)=>(k(),E("div",At,[c("div",Mt,[W(m(ke),{class:"mb-8"},{default:K(()=>[c("div",Pt,[n[5]||(n[5]=c("div",{class:"flex-1"},[c("h1",{class:"text-xl md:text-2xl font-medium text-green-800 mb-2"}," Welcome to your AI Chat Assistant! "),c("p",{class:"text-gray-600 text-lg"}," Here you can explore your brand's performance data and metrics through natural conversation. Ask about sentiment trends, review patterns, or competitive insights for clear, data-driven answers. Think of me as your brand analytics expert, ready to help you understand your impact in the cannabis community today. ")],-1)),c("div",$t,[c("img",{src:m(Ct),alt:"AI Chat Assistant illustration",class:"w-full h-full object-contain"},null,8,Lt)])])]),_:1}),m(D)?(k(),Z(m(Ue),{key:0,variant:"destructive",class:"mb-4"},{default:K(()=>[W(m(Ze),null,{default:K(()=>[re(Q(m(D)),1)]),_:1})]),_:1})):J("",!0),W(m(ke),{class:"mb-8 overflow-hidden"},{default:K(()=>[W(m(lt),{class:"bg-gray-50 rounded-t-lg"}),W(m(ct),{class:"p-0"},{default:K(()=>[c("div",{ref_key:"chatContainer",ref:e,class:"h-[720px] overflow-y-auto p-4 scroll-smooth bg-white"},[m(r).length?(k(),E("div",Nt,[(k(!0),E(j,null,Y(m(r),t=>{var C,T;return k(),E("div",{key:t.id,class:ie(["flex flex-col",t.sender==="user"?"items-end":"items-start"]),onMounted:()=>{console.log("Message sentiment:",t.sentiment)}},[c("div",{class:ie(["p-4 rounded-lg whitespace-pre-line",t.visualization?"max-w-[950px]":"max-w-[70%]",t.sender==="user"?"bg-green-100 text-green-800":"bg-white border border-gray-200"])},[t.sender==="ai"&&t.text.includes("Context:")?(k(),E("div",Tt,[(k(!0),E(j,null,Y(t.text.split(`

`),(M,b)=>(k(),E("div",{key:b},[M.includes("Context:")?(k(),E(j,{key:0},[c("div",Vt,[W(St,{sentiment:(()=>{const u=M.toLowerCase(),[s,h]=u.split("context:");return u.includes("worst")||u.includes("lacking")||u.includes("shit")||u.includes("problems")?"negative":u.includes("epic")||u.includes("celebrate")||u.includes("amazing")||u.includes("love")||u.includes("cant wait")||u.includes("this light is amazing")||s.includes("hcc")&&(h!=null&&h.includes("viparspectra"))?"positive":"neutral"})()},null,8,["sentiment"]),c("span",null,Q(M.split(`
`)[0]),1)]),c("div",Bt,Q(M.split(`
`)[1]),1)],64)):(k(),E("span",Ot,Q(M),1))]))),128))])):(k(),E("div",Ht,[c("div",Wt,[c("p",{class:"text-[16px] leading-relaxed whitespace-pre-wrap",innerHTML:t.text.replace(/##LINK\[(.*?)\]##🔗##/g,"<a href='$1' target='_blank'>🔗</a>")},null,8,Gt),t.text==="🤖 Robot brain doing backflips..."?(k(),Z(m(Ce),{key:0,class:"h-4 w-4 animate-spin text-green-600"})):J("",!0)]),(T=(C=t.insights)==null?void 0:C.recommendations)!=null&&T.length?(k(),E("div",It,[n[8]||(n[8]=c("p",{class:"font-semibold text-green-800 text-[16px] mb-2"},"Recommended Actions:",-1)),c("ul",qt,[(k(!0),E(j,null,Y(t.insights.recommendations,(M,b)=>(k(),E("li",{key:b,class:"ml-2"},Q(M),1))),128))])])):J("",!0)])),t.visualization?(k(),E("div",{key:`viz-container-${t.id}`,class:"mt-4 w-[850px] h-[400px] bg-white rounded-lg border border-gray-200 p-4"},[W(yt,{"message-id":t.id,data:t.visualization.data,type:t.visualization.type,config:t.visualization.config,onLoaded:y},null,8,["message-id","data","type","config"])])):J("",!0)],2)],42,Et)}),128))])):(k(),E("div",zt,[c("div",Dt,[W(m(Xe),{class:"w-8 h-8 text-green-500"})]),n[6]||(n[6]=c("h3",{class:"text-lg font-medium text-gray-900 mb-2"}," Ask Me Anything ",-1)),n[7]||(n[7]=c("p",{class:"text-gray-500 text-sm mb-5 max-w-[600px]"}," Ask me questions about brand monitoring, market trends, or get help analyzing your data. ",-1))]))],512),c("div",Rt,[c("div",Qt,[W(m(Ye),{modelValue:m(w),"onUpdate:modelValue":n[0]||(n[0]=t=>et(w)?w.value=t:null),onKeypress:v,placeholder:"Type your message here...",class:"flex-1 text-[16px] h-11",disabled:m(a)},null,8,["modelValue","disabled"]),W(m(oe),{onClick:n[1]||(n[1]=()=>N(m(w))),class:"bg-green-600 hover:bg-green-700 text-white",disabled:m(a)},{default:K(()=>[m(a)?(k(),Z(m(Ce),{key:0,class:"h-4 w-4 mr-2 animate-spin"})):(k(),Z(m(tt),{key:1,class:"h-4 w-4 mr-2"})),re(" "+Q(m(a)?"Processing...":"Send"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1}),c("button",{onClick:n[2]||(n[2]=t=>o.value=!0),class:"fixed bottom-6 right-6 flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-full shadow-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2"},[W(m(at),{class:"h-5 w-5"}),n[9]||(n[9]=c("span",null,"Example Questions",-1))]),o.value?(k(),E("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:n[3]||(n[3]=t=>o.value=!1)})):J("",!0),o.value?(k(),E("div",{key:2,class:ie(["fixed inset-y-0 right-0 w-96 bg-[#fafafa] shadow-xl z-50 transform transition-transform duration-300",o.value?"translate-x-0":"translate-x-full"])},[c("div",Ft,[n[10]||(n[10]=c("div",{class:"flex items-center gap-2"},[c("div",{class:"w-1 h-6 bg-green-500 rounded-full shadow-sm"}),c("h2",{class:"text-lg font-semibold text-gray-800"},"Example Questions")],-1)),c("button",{onClick:n[4]||(n[4]=t=>o.value=!1),class:"text-gray-400 hover:text-gray-600 hover:bg-gray-100 p-1.5 rounded-lg transition-colors"},[W(m(nt),{class:"h-5 w-5"})])]),c("div",{ref_key:"questionsPanel",ref:l,class:"h-[calc(100vh-8rem)] overflow-y-auto questions-panel relative",onScroll:_},[c("div",Kt,[c("div",Jt,[c("div",jt,[W(m(rt),{class:"w-4 w-4 text-green-600"}),n[11]||(n[11]=c("h3",{class:"font-medium"},"Quick Questions",-1))]),c("div",Zt,[(k(!0),E(j,null,Y(m(p),t=>(k(),Z(m(oe),{key:t,variant:"ghost",class:"w-full justify-start h-auto py-2.5 px-4 text-left text-sm hover:bg-gray-50 text-gray-700 hover:text-gray-900",onClick:C=>{m(L)(t),o.value=!1},disabled:m(a)},{default:K(()=>[re(Q(t),1)]),_:2},1032,["onClick","disabled"]))),128))])]),(k(!0),E(j,null,Y(m(B),t=>(k(),E("div",{key:t.category,class:"space-y-3 bg-white p-4 rounded-xl shadow-sm border border-gray-100"},[c("div",Ut,[W(m(st),{class:"w-4 w-4 text-green-600"}),c("h3",Xt,Q(t.category),1)]),c("div",Yt,[(k(!0),E(j,null,Y(t.questions,C=>(k(),Z(m(oe),{key:C,variant:"ghost",class:"w-full justify-start h-auto py-2 px-3 text-left text-sm hover:bg-gray-50 text-gray-700 hover:text-gray-900",onClick:T=>{m(L)(C),o.value=!1},disabled:m(a)},{default:K(()=>[W(m(it),{class:"h-4 w-4 mr-2 text-green-600"}),re(" "+Q(C),1)]),_:2},1032,["onClick","disabled"]))),128))])]))),128))]),d.value?(k(),E("div",ea,[n[12]||(n[12]=c("div",{class:"bg-gradient-to-t from-[#fafafa] to-transparent h-24 w-full absolute bottom-0"},null,-1)),c("div",ta,[W(m(ut),{class:"h-5 w-5 animate-bounce"})])])):J("",!0)],544)],2)):J("",!0)])]))}}),ia=ot(aa,[["__scopeId","data-v-8bc58b56"]]);export{ia as default};
//# sourceMappingURL=ChatPage-CrYh4CPu.js.map
